/*!
 * Copyright (c) 2014 Stefan Aichholzer <theaichholzer@gmail.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */
'use strict';var salvus={extraho:function(t){var n=t.match(/\[([^\]]+)]|\(([^)]+)\)|{([^}]+)}/),r;if(n){r={semita:t.substr(0,t.search(/\(|\[|\{/)).split("."),elementum:{}};n=(n[1]||n[2]||n[3]).split(",");n.forEach(function(e){e=e.trim().split(":");r.elementum[e[0]]=e[1]})}return r},noto:function(t){if(!t){return this}var n=this,r,i;t=Array.isArray(t)?t:t.split();t.forEach(function(e){i=salvus.extraho(e);if(i){r=i.semita}else{e=e.split(":");r=e[0].split(".")}for(var t=0;t<r.length-1;++t){if(!n[r[t]]){n[r[t]]={}}n=n[r[t]]}if(i){n[r[r.length-1]]=n[r[r.length-1]]||{};for(var s in i.elementum){if(i.elementum.hasOwnProperty(s)){i.elementum[s]=i.elementum[s]==="true"?true:i.elementum[s]==="false"?false:i.elementum[s];n[r[r.length-1]][s]=i.elementum[s]}}}else{e[1]=e[1]==="true"?true:e[1]==="false"?false:e[1];n[r[r.length-1]]=e[1]}});return this},lego:function(t,n,r,i){if(!t){return undefined}var s=this,o=t.split("."),u;for(var a=0;a<o.length;++a){u=s[o[a].trim()];u=r?u||false:u||u===null?u:false;if(u||u===null){s=u}else{return n?(i||"!!")+o[a]:undefined}}return u},erado:function(t){if(!t){return this}return this.noto(t).purgo(false,true)},purgo:function(t,n){var r=t||this,i,s,o,u;for(var a in r){if(r.hasOwnProperty(a)){i=Array.isArray(r[a]);s=i&&r[a].length===0;o=!i&&r[a]&&typeof r[a]==="object";u=o&&Object.keys(r[a]).length===0;if(o&&!u){salvus.purgo(r[a],n)}else if(!r[a]||s||u){if(n&&r[a]===null){continue}delete r[a];salvus.purgo(r,n)}}}return r}};module.exports=function(){Object.prototype.noto=salvus.noto;Object.prototype.lego=salvus.lego;Object.prototype.erado=salvus.erado;Object.prototype.purgo=salvus.purgo}();
